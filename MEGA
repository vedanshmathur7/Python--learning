import pyperclip
import os
import pyautogui
import time

pyautogui.FAILSAFE = False

def open_chatgpt():
    try:
        # Path to launch Brave browser with ChatGPT
        app_path = r'C:\Program Files\BraveSoftware\Brave-Browser\Application\brave.exe'
        url = 'https://chatgpt.com/'
        os.startfile(app_path)
        time.sleep(2)  # Wait for the browser to open
        pyautogui.typewrite(url)
        pyautogui.press('enter')
    except Exception as e:
        print(f"Error: {e}")

def copythecontent():
    pyautogui.click(982, 1049)

    time.sleep(1)  # Wait for 1 second to ensure the click is registered
    while True:
        time.sleep(5)
        # Step 2: Drag the mouse from (1003, 237) to (2187, 1258) to select the text
        pyautogui.click(215, 242)
        pyautogui.moveTo(448, 141)
        pyautogui.dragTo(486, 901, duration=2.0, button='left')  # Drag for 1 second

        # Step 3: Copy the selected text to the clipboard
        pyautogui.hotkey('ctrl', 'c')
        time.sleep(2)  # Wait for 1 second to ensure the copy command is completed

        # Step 4: Open ChatGPT
        open_chatgpt()
        break  # Exit the loop after opening ChatGPT

if __name__ == "__main__":
    copythecontent()